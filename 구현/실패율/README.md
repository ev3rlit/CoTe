# 실패율

#구현 #정렬 #2019KAKAOBLIND

[문제 링크](https://school.programmers.co.kr/learn/courses/30/lessons/42889)

# 문제 난이도 하

## 1. 📊 객관적 분석 및 근거

### 1.1 제약 조건 파악

| 항목 | 값 | 의미 |
|------|-----|------|
| `N` (스테이지 수) | 1 ~ 500 | 스테이지 수는 매우 적음 |
| `stages` 길이 (사용자 수) | 1 ~ 200,000 | 사용자 수는 꽤 많음 |
| 시간 제한 | 일반적 | O(M) 또는 O(N log N) 필요 |

### 1.2 알고리즘 선택 및 논증

**핵심 아이디어**:
- 각 스테이지별 도달한 사람 수와 클리어하지 못한 사람 수를 세야 함.
- `stages`를 한 번 순회하며 각 스테이지에 멈춰있는 사람 수를 센다. (O(M))
- 스테이지 1부터 N까지 순회하며 실패율을 계산한다. (O(N))
- 실패율 기준 정렬 (O(N log N))

## 2. 🧠 자연어 실행 흐름

1. **상태 집계**:
   - `stages` 배열을 순회하며 각 스테이지에 머물러 있는 사람 수를 카운팅한다. (`challengers` 딕셔너리)
   - 전체 사용자 수 `users`를 초기화한다.

2. **실패율 계산**:
   - 1번 스테이지부터 N번 스테이지까지 반복:
     - 현재 스테이지에 도달한 사람 (`users`)이 0명이면 실패율은 0.
     - 도달한 사람이 있다면 `실패율 = 현재 스테이지 멈춘 사람 / 도달한 사람`
     - 다음 스테이지로 넘어갈 때, 현재 스테이지에 멈춘 사람만큼 `users`에서 뺀다.
     - (스테이지 번호, 실패율)을 리스트에 저장.

3. **정렬 및 반환**:
   - 실패율 내림차순, 스테이지 번호 오름차순으로 정렬.
   - 스테이지 번호만 추출하여 반환.

---

# 평가

## 개선할 점

1. **치명적인 버그: 도달한 유저가 없는 경우**
   - 코드의 27-28라인 `if users <= 0: continue`는 문제가 있습니다.
   - 도달한 유저가 없는 스테이지도 결과 리스트에 포함되어야 하며, 이때 실패율은 0이어야 합니다.
   - `continue`를 하면 해당 스테이지가 결과에서 아예 누락되어 정답 길이가 N보다 작아집니다.
   - **수정 제안**:
     ```python
     if users <= 0:
         failures.append((stage, 0)) # 실패율 0으로 추가
         continue
     ```

2. **변수 명명**
   - `users`보다는 `players_reached`나 `current_challengers` 같이 의미가 더 명확한 변수명이 좋습니다.

## 잘한 점

1. **효율적인 카운팅**
   - `stages`를 매번 `count()` 메서드로 세지 않고, `defaultdict`로 한 번만 순회하여 시간 복잡도를 O(M)으로 잘 최적화했습니다. (`count()` 사용 시 O(N*M)으로 시간 초과 가능성 있음)

2. **정렬 로직**
   - `key=lambda x: (-x[1], x[0])`를 사용하여 실패율 내림차순, 스테이지 오름차순 조건을 깔끔하게 처리했습니다.

3. **누적 감산 방식**
   - 전체 인원에서 해당 스테이지 탈락자를 빼나가며 도달 인원을 계산한 로직이 효율적입니다.

## 다른 응용 방안

- **히스토그램 생성**: 데이터 분포를 구간별로 집계할 때 유사한 로직 사용
- **누적 합(Prefix Sum) 응용**: 구간 합이나 누적 통계를 낼 때 사용

## 추천 문제

| 문제 | 플랫폼 | 핵심 패턴 |
|------|--------|----------|
| [H-Index](https://programmers.co.kr/learn/courses/30/lessons/42747) | 프로그래머스 | 정렬, 조건부 카운팅 |
| [예산](https://programmers.co.kr/learn/courses/30/lessons/12982) | 프로그래머스 | 정렬, 누적 합 |

## 종합 평가

문제의 핵심인 실패율 계산 공식을 정확히 이해하고, 시간 복잡도를 고려하여 O(N + M) 방식으로 효율적으로 설계했습니다. 다만, **도달한 유저가 0명일 때의 예외 처리**에서 `continue`를 사용하여 결과 배열의 길이가 달라지는 버그가 발생했습니다. 코딩 테스트에서는 예외 케이스(N=500, users=0 등)를 항상 주의해야 합니다. 이 버그만 수정하면 완벽한 풀이입니다.
